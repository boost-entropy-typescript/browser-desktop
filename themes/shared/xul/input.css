/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

@namespace xul url("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul");
@namespace html url("http://www.w3.org/1999/xhtml");

button,
select,
xul|button,
html|button,
html|select {
    --button-disabled-opacity: 0.5;

    --button-base-color: currentColor;
    --button-mix-color: transparent;

    --button-override-default-color-mix: 10%;
    --button-override-hover-color-mix: 15%;
    --button-override-active-color-mix: 30%;
    --button-override-checked-color-mix: 30%;
    --button-override-checked-hover-color-mix: 35%;
    --button-override-checked-active-color-mix: 40%;

    --button-default-color: color-mix(in srgb, var(--button-base-color) var(--button-override-default-color-mix), var(--button-mix-color));
    --button-hover-color: color-mix(in srgb, var(--button-base-color) var(--button-override-hover-color-mix), var(--button-mix-color));
    --button-active-color: color-mix(in srgb, var(--button-base-color) var(--button-override-active-color-mix), var(--button-mix-color));
    --button-checked-color: color-mix(in srgb, var(--button-base-color) var(--button-override-checked-color-mix), var(--button-mix-color));
    --button-checked-hover-color: color-mix(in srgb, var(--button-base-color) var(--button-override-checked-hover-color-mix), var(--button-mix-color));
    --button-checked-active-color: color-mix(in srgb, var(--button-base-color) var(--button-override-checked-active-color-mix), var(--button-mix-color));

    --button-ease-out-quad: cubic-bezier(0.25, 0.46, 0.45, 0.94);

    --browser-high-contrast-color: color-mix(in srgb, currentColor 100%, transparent 50%);
}

button,
select,
xul|button,
html|button,
html|select {
    appearance: none;

    min-height: 24px;
    min-width: 16px;

    border: none;
    border-radius: 6px;

    font-size: 14px;
    font-weight: 500;

    color: var(--button-color, currentColor);
    background-color: var(--button-background, var(--button-default-color));

    outline: var(--button-outline);
    outline-offset: var(--button-outline-offset);

    transition: var(--button-transition);

    z-index: var(--button-z-index);

    --button-transition: background 200ms var(--button-ease-out-quad),
        outline 25ms var(--button-ease-out-quad),
        outline-offset var(--button-outline-offset-transition-duration, 50ms) var(--button-ease-out-quad);
}

button,
xul|button,
html|button {
    padding: 6px 24px;
}

select,
html|select {
    padding: 6px 14px;

    background-image: url(chrome://dot/skin/chevron-down.svg);
    background-repeat: no-repeat;
    background-position: calc(100% - 10px) center;
    -moz-context-properties: fill;
    fill: currentColor;
}

button:hover:not(:disabled),
select:focus:not(:disabled),
xul|button:hover:not(:disabled),
html|button:hover:not(:disabled),
html|select:hover:not(:disabled),
html|select:focus:not(:disabled) {
    --button-background: var(--button-hover-color);
}

button:is(:hover, :focus-visible):is(:active, [active], [mouseactive]):not(:disabled),
select:is(:focus-visible):is(:active, [active], [mouseactive]):not(:disabled),
xul|button:is(:hover, :focus-visible):is(:active, [active], [mouseactive]):not(:disabled),
html|button:is(:hover, :focus-visible):is(:active, [active], [mouseactive]):not(:disabled),
html|select:is(:focus-visible):is(:active, [active], [mouseactive]):not(:disabled) {
    --button-background: var(--button-active-color);
}

button:disabled>*,
select:disabled,
xul|button:disabled>*,
html|button:disabled>*,
html|select:disabled,
button[disabled],
select[disabled],
xul|button[disabled],
html|button[disabled],
html|select[disabled] {
    filter: opacity(var(--button-disabled-opacity));
}

button:focus-visible:not(:is(:active, [active], [mouseactive])),
select:focus-visible,
xul|button:focus-visible:not(:is(:active, [active], [mouseactive])),
html|button:focus-visible:not(:is(:active, [active], [mouseactive])),
html|select:focus-visible {
    --button-background: var(--button-hover-color);

    --button-outline: 2px solid AccentColor;
    --button-outline-offset: 2px;

    --button-z-index: 2147483647;
}

button:focus-visible:is(:active, [active], [mouseactive]),
xul|button:focus-visible:is(:active, [active], [mouseactive]),
html|button:focus-visible:is(:active, [active], [mouseactive]) {
    --button-outline: 2px solid AccentColor;
    --button-outline-offset: 0px;

    --button-outline-offset-transition-duration: 100ms;
}

button[primary],
xul|button[primary],
html|button[primary] {
    --button-base-color: AccentColor;
    --button-mix-color: currentColor;
    --button-color: white;

    --button-override-default-color-mix: 100%;
    --button-override-hover-color-mix: 85%;
    --button-override-active-color-mix: 70%;
    --button-override-checked-color-mix: 70%;
    --button-override-checked-hover-color-mix: 60%;
    --button-override-checked-active-color-mix: 55%;
}

@media (prefers-contrast) {

    button:not(:disabled),
    select:not(:disabled),
    xul|button:not(:disabled),
    html|button:not(:disabled),
    html|select:not(:disabled) {
        outline: 1px solid var(--browser-high-contrast-color);
    }
}